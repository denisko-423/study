**1. Попасть в систему без пароля несколькими способами**
=========================================================

Собственно, попасть в систему без какого-либо пароля можно только одним способом – загрузиться в однопользовательском режиме (single user mode). При этом в память загружается только образ initrd с минимально необходимым функционалом, монтируются локальные файловые системы, но сетевые интерфейсы неактивны, и в системе может работать только один пользователь root.

При использовании загрузчика GRUB это достигается правкой меню загрузки. Если меню загрузки не отображается (например, установлен параметр GRUB_TIMEOUT=0), то надо удерживать Shift при загрузке. В меню следует выбрать нужный пункт загрузки и нажать ‘e’:
![1_press_e](./img/1_press_e.png)

Изменения вносятся в выделенную строку (linux16 для RHEL/CentOS 7, linux для RHEL/CentOS 8):
(2)
Сделанные таким образом изменения однократные, применяются только при данной загрузке. Далее возможны три варианта.

1) init=/bin/bash (/bin/sh)
Дописать запуск оболочки в строку, желательно удалить “rhgb quiet”, чтобы видеть процесс загрузки. Файловую систему root можно сразу смонтировать в режиме rw, заменив ro:
(3)
По окончании загрузки получаем:
(4)
Теперь можно штатными средствами задать новый пароль для рута. Перед перезагрузкой нужно создать файл /.autorelabel – указание для системы SELinux принять изменения:
(5)

2) rd.break
Дописать в строку rd.break:
(6)
По окончании загрузки попадаем в “аварийный режим” (emergency mode). Рутовая файловая система смонтирована в каталоге /sysroot в режиме “только чтение”. Перемонтируем в режим записи, входим “внутрь” ФС (chroot), выполняем необходимые действия, создаем “внутри” файл /.autorelabel и перезагружаемся:
(7)

3) rw init=/sysroot/bin/bash
Заменяем параметр rw на указанную строку:
(8)
Рутовая файловая система смонтирована в режиме rw. Действия аналогично методу 2:
(9)

2. Установить систему с LVM, после чего переименовать VG.

Система установлена на логических томах LVM, имя Volume Group vghw6:
(10)
Переименовываем VG, меняем старое название на новое в указанных файлах (опция -i позволяет сохранить исходную версию в файле с суффиксом .sav), пересоздаем initrd с новым именем VG:
(11)
После перезагрузки видим новое имя VG:
(12)

3. Добавить модуль в initrd.

Создаем указанный каталог, в него помещаем файлы module-setup.sh и test.sh:
(13)
Текст скрипта module-setup.sh, который устанавливает модуль и вызывает скрипт test.sh:
(14)
(15)
Текст скрипта test.sh, при выполнении которого на экране в течение 30 секунд отображается геометрический рисунок:
(16)
Пересоздаем initrd, чтобы модуль добавился в образ, из-за малого размера экрана лог работы сохраняем в файл log:
(17)
Просмотр лога (less log) показал, что ошибок нет, модуль добавился успешно.
Чтобы при загрузке увидеть работу модуля, в меню загрузки boot/grub2/grub.cfg из нужного пункта удаляем “rhgb quiet”:
(18)
В ходе перезагрузки модуль отработал успешно:
(19)

